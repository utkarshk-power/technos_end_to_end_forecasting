schema: '2.0'
stages:
  preprocess:
    cmd: python src/preprocess.py
    deps:
    - path: data/raw/aichi_temp.csv
      hash: md5
      md5: b65fa9ab078b87a24e369a56ac0cffe3
      size: 20514
    - path: data/raw/technos_data_23aug_22sept.csv
      hash: md5
      md5: f7d055259b81677c4aeae9d1f370a062
      size: 185779
    - path: src/preprocess.py
      hash: md5
      md5: b443b61fdeeeb3ed9b0d8ba70b282327
      size: 4932
    params:
      params.yaml:
        preprocess:
          input_temperature: data/raw/aichi_temp.csv
          input: data/raw/technos_data_23aug_22sept.csv
          output: data/processed/processed_data.csv
          drop_rows: 11
          start_date: '2025-08-23 02:00:00'
          end_date: '2025-09-21 13:00:00'
          lag_time: 5
          temperature:
            encoding: cp932
            skiprows: 3
    outs:
    - path: ./data/processed/processed_data.csv
      hash: md5
      md5: e2b992733c6e69276aeed925d3d30376
      size: 151636
  train:
    cmd: python src/train.py
    deps:
    - path: data/processed/processed_data.csv
      hash: md5
      md5: e2b992733c6e69276aeed925d3d30376
      size: 151636
    - path: params.yaml
      hash: md5
      md5: 42cbe8639097f17659971bb2e21a3a9c
      size: 1177
    - path: src/train.py
      hash: md5
      md5: 135e4090f282f23ae6c351d4cf71fbc4
      size: 4461
    outs:
    - path: models/model.pkl
      hash: md5
      md5: f37124f978ef7bf2c29c3a74fab2a3eb
      size: 233174
  evaluate:
    cmd: python src/evaluate.py
    deps:
    - path: data/processed/processed_data.csv
      hash: md5
      md5: e2b992733c6e69276aeed925d3d30376
      size: 151636
    - path: models/model.pkl
      hash: md5
      md5: f37124f978ef7bf2c29c3a74fab2a3eb
      size: 233174
    - path: src/evaluate.py
      hash: md5
      md5: fb4e13b5e9a261041dd64d3d2a7cb387
      size: 1867
    params:
      params.yaml:
        evaluate:
          data: data/processed/processed_data.csv
          model: models/model.pkl
          train_size: 0.7
          val_size: 0.15
          test_size: 0.15
          random_state: 42
          feature_cols:
          - Hour
          - Average_Temperature_C
          - Day_of_Week
          - Month
          - DayOfYear
          - netload_lag1
          - netload_lag2
          - netload_lag3
          - netload_lag4
          - netload_lag5
          target_col: netload
  testing:
    cmd: bash -lc 'mkdir -p test_reports && PYTHONPATH=. pytest -q tests | tee 
      test_reports/test_results.txt'
    deps:
    - path: data/processed/aichi_temperature_forecast.csv
      hash: md5
      md5: 77a255f05cc39657565033828152e34d
      size: 2428
    - path: data/processed/inference_input_data.csv
      hash: md5
      md5: fd11a2c760e26f8cc603ea83f92656ab
      size: 1746
    - path: data/processed/inference_lag_data.csv
      hash: md5
      md5: 8b23bb3161e5d1a5c4bb4bc07091b3e6
      size: 1325
    - path: data/processed/processed_data.csv
      hash: md5
      md5: e2b992733c6e69276aeed925d3d30376
      size: 151636
    - path: inference.yaml
      hash: md5
      md5: 97e42ff1cd99c60df2433361e9ea8283
      size: 1334
    - path: models/model.pkl
      hash: md5
      md5: f37124f978ef7bf2c29c3a74fab2a3eb
      size: 233174
    - path: params.yaml
      hash: md5
      md5: 42cbe8639097f17659971bb2e21a3a9c
      size: 1177
    - path: src
      hash: md5
      md5: a8931c7c3c01d55463d7bf5ebfcf77b4.dir
      size: 22243
      nfiles: 10
    - path: tests
      hash: md5
      md5: b0f213f4e61507d49a0937b40db93572.dir
      size: 2725
      nfiles: 2
    - path: tests/test_deployment.py
      hash: md5
      md5: 589bff36e894f285c263bb3924f90efb
      size: 1602
    - path: tests/test_preprocess.py
      hash: md5
      md5: 0d75c7f7530a15bf10a9f3a3f241ccee
      size: 1123
    outs:
    - path: test_reports/test_results.txt
      hash: md5
      md5: cb7735dfe4af33ddc8884e2477a62bc9
      size: 1365
